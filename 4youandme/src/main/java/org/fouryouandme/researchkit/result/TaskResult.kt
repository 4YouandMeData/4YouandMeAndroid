package org.fouryouandme.researchkit.result

import java.io.Serializable

/**
 * An TaskResult object is a result that contains all the step results generated from one run of a
 * task
 *
 * A task result is typically generated by the framework as the task proceeds. When the task
 * completes, it may be appropriate to serialize it for transmission to a server, or to immediately
 * perform analysis on it.
 *
 */
class TaskResult(identifier: String) : Result(identifier) {

    /**
     * Contains the step results for the task.
     */
    private var results: MutableMap<String, StepResult<*>> = mutableMapOf()

    /**
     * Store extra details needed for parsing the result in the taskDetails
     */
    val taskDetails: MutableMap<String, Serializable> = mutableMapOf()

    /**
     * Set the Map of all of the StepResults in the task.
     * @param newResults set the results object
     */
    fun setResults(newResults: MutableMap<String, StepResult<*>>) {
        results = newResults
    }

    /**
     * Returns a Map of all of the StepResults in the task.
     *
     * @return a Map of the StepResults
     */
    fun getResults(): Map<String, StepResult<*>> = results

    /**
     * Returns a step result for the specified step identifier, if one exists.
     *
     * @param identifier The identifier for which to search.
     * @return The result for the specified step, or null for none.
     */
    fun getStepResult(identifier: String): StepResult<*>? = results[identifier]

    /**
     * Sets the result for the step using the step's identifier as a key.
     *
     * @param identifier the Step and StepResult's identifier
     * @param stepResult the StepResult for this identifier
     */
    fun setStepResultForStepIdentifier(
        identifier: String,
        stepResult: StepResult<*>
    ) {
        results[identifier] = stepResult
    }

}